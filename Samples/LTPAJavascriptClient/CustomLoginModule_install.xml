<?xml version="1.0" encoding="UTF-8"?>
<!--    
# Copyright (c) 2011-2021 Contributors to the Eclipse Foundation
# 
# See the NOTICE file(s) distributed with this work for additional
# information regarding copyright ownership.
# 
# This program and the accompanying materials are made available under the
# terms of the Eclipse Public License 2.0 which is available at
# http://www.eclipse.org/legal/epl-2.0
# 
# SPDX-License-Identifier: EPL-2.0
#
-->

<!-- Sample configuration of a WebSphere Application Server Liberty profile
     with Derby databases. -->

<project basedir="." default="help">

  <!-- PROPERTIES, TO BE ADJUSTED BEFORE USE. -->

  <!-- The war file generated by IBM Worklight Studio for the project. -->
  <property name="worklight.project.war.file" value="/home/llin/InstallApp/LoginModule/module_23_1_CustomLoginModule.war"/>

  <!-- Installation directory of IBM Worklight Server. -->
  <property name="worklight.server.install.dir" value="/opt/IBM/Worklight"/>

  <!-- The directory in which to create or assume the Derby databases. -->
  <property name="derby.databases.data.dir" value="/var/ibm/Worklight/derby"/>

  <!-- Installation directory of IBM WebSphere Application Server Liberty profile. -->
  <property name="was.liberty.install.dir" value="/opt/IBM/WebSphere/Liberty"/>
  <!-- The name of the Liberty server. -->
  <property name="was.liberty.server.name" value="Worklightserver"/>

  <!-- The directory in which to place shortcuts. -->
  <property name="shortcuts.dir" value="/opt/IBM/Worklight/WorklightServer/install/shortcuts"/>

  <!-- The directory in which to place BIRT reports. -->
  <property name="reports.dir" value="/tmp/reports"/>

  <!-- END OF PROPERTIES. -->


  <taskdef resource="com/worklight/ant/defaults.properties">
    <classpath>
      <fileset dir="${worklight.server.install.dir}/WorklightServer">
        <include name="worklight-ant.jar"/>
      </fileset>
    </classpath>
  </taskdef>

  <target name="databases">
    <configuredatabase kind="Worklight">
      <derby database="WRKLGHT" datadir="${derby.databases.data.dir}"/>
    </configuredatabase>
    <configuredatabase kind="WorklightReports">
      <derby database="WLREPORT" datadir="${derby.databases.data.dir}"/>
    </configuredatabase>
  </target>

  <target name="install">
    <configureapplicationserver shortcutsDir="${shortcuts.dir}">
      <project warfile="${worklight.project.war.file}"/>
      <property name="serverSessionTimeout" value="10"/>
      <applicationserver>
        <websphereapplicationserver installdir="${was.liberty.install.dir}" profile="Liberty">
          <server name="${was.liberty.server.name}"/>
        </websphereapplicationserver>
      </applicationserver>
      <reports todir="${reports.dir}"/>
      <database kind="Worklight">
        <derby database="WRKLGHT" datadir="${derby.databases.data.dir}"/>
      </database>
      <database kind="WorklightReports">
        <derby database="WLREPORT" datadir="${derby.databases.data.dir}"/>
      </database>
    </configureapplicationserver>
  </target>

  <target name="uninstall">
    <unconfigureapplicationserver shortcutsDir="${shortcuts.dir}">
      <project warfile="${worklight.project.war.file}"/>
      <property name="serverSessionTimeout" value="10"/>
      <applicationserver>
        <websphereapplicationserver installdir="${was.liberty.install.dir}" profile="Liberty">
          <server name="${was.liberty.server.name}"/>
        </websphereapplicationserver>
      </applicationserver>
      <reports todir="${reports.dir}"/>
      <database kind="Worklight">
        <derby database="WRKLGHT" datadir="${derby.databases.data.dir}"/>
      </database>
      <database kind="WorklightReports">
        <derby database="WLREPORT" datadir="${derby.databases.data.dir}"/>
      </database>
    </unconfigureapplicationserver>
  </target>

  <target name="help">
    <basename property="ant.file.basename" file="${ant.file}"/>
    <echo message="This ant project file can be used in three ways:"/>
    <echo/>
    <echo message="ant -f ${ant.file.basename} databases"/>
    <echo message="Configures the databases for use with a Worklight project."/>
    <echo/>
    <echo message="ant -f ${ant.file.basename} install"/>
    <echo message="Installs a Worklight project in the application server."/>
    <echo/>
    <echo message="ant -f ${ant.file.basename} uninstall"/>
    <echo message="Uninstalls a Worklight project from the application server."/>
    <echo/>
  </target>
</project>
